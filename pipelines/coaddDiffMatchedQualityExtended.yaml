description: |
  Matched difference (measured vs reference) plots/metrics
tasks:
  diff_matched_analysis:
    class: lsst.analysis.tools.tasks.DiffMatchedAnalysisTask
    config:
      connections.outputName: diff_matched_truth_summary_objectTable_tract

      # plots
      atools.matchedRefCModelMagDiffPlot: MatchedRefCoaddDiffMagPlot

      atools.matchedRefMagChiPlot: MatchedRefCoaddDiffMagPlot
      atools.matchedRefMagChiPlot.compute_chi: True

      # TODO: Can this be a one liner?
      atools.matchedRefPositionXDiffPlot: MatchedRefCoaddDiffPositionPlot
      atools.matchedRefPositionXDiffPlot.variable: x

      atools.matchedRefPositionXChiPlot: MatchedRefCoaddDiffPositionPlot
      atools.matchedRefPositionXChiPlot.variable: x
      atools.matchedRefPositionXChiPlot.compute_chi: True

      atools.matchedRefPositionYDiffPlot: MatchedRefCoaddDiffPositionPlot
      atools.matchedRefPositionYDiffPlot.variable: y

      atools.matchedRefPositionYChiPlot: MatchedRefCoaddDiffPositionPlot
      atools.matchedRefPositionYChiPlot.variable: y
      atools.matchedRefPositionYChiPlot.compute_chi: True

      # metrics
      atools.matchedRefCModelMagDiffMetric: MatchedRefCoaddDiffMagMetric

      atools.matchedRefMagChiMetric: MatchedRefCoaddDiffMagMetric
      atools.matchedRefMagChiMetric.compute_chi: True

      atools.matchedRefPositionXDiffMetric: MatchedRefCoaddDiffPositionMetric
      atools.matchedRefPositionXDiffMetric.variable: x

      atools.matchedRefPositionXChiMetric: MatchedRefCoaddDiffPositionMetric
      atools.matchedRefPositionXChiMetric.variable: x
      atools.matchedRefPositionXChiMetric.compute_chi: True

      atools.matchedRefPositionYDiffMetric: MatchedRefCoaddDiffPositionMetric
      atools.matchedRefPositionYDiffMetric.variable: y

      atools.matchedRefPositionYChiMetric: MatchedRefCoaddDiffPositionMetric
      atools.matchedRefPositionYChiMetric.variable: y
      atools.matchedRefPositionYChiMetric.compute_chi: True

      python: |
        from lsst.analysis.tools.atools.diffMatched import (
          MatchedRefCoaddDiffMagMetric,
          MatchedRefCoaddDiffPositionMetric,
          MatchedRefCoaddDiffMagPlot,
          MatchedRefCoaddDiffPositionPlot,
        )
