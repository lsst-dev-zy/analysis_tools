description: |
  Matched difference (measured vs reference) plots/metrics
tasks:
  diff_matched_analysis:
    class: lsst.analysis.tools.tasks.DiffMatchedAnalysisTask
    config:
      connections.outputName: diff_matched_truth_summary_objectTable_tract

      # plots
      atools.matchedRefCModelMagDiff: MatchedRefCoaddDiffMagTool

      atools.matchedRefCModelMagChi: MatchedRefCoaddDiffMagTool
      atools.matchedRefCModelMagChi.compute_chi: true

      # TODO: Can this be a one liner?
      atools.matchedRefPositionXDiff: MatchedRefCoaddDiffPositionTool
      atools.matchedRefPositionXDiff.variable: x

      atools.matchedRefPositionXChi: MatchedRefCoaddDiffPositionTool
      atools.matchedRefPositionXChi.variable: x
      atools.matchedRefPositionXChi.compute_chi: true

      atools.matchedRefPositionYDiff: MatchedRefCoaddDiffPositionTool
      atools.matchedRefPositionYDiff.variable: y

      atools.matchedRefPositionYChi: MatchedRefCoaddDiffPositionTool
      atools.matchedRefPositionYChi.variable: y
      atools.matchedRefPositionYChi.compute_chi: true

      python: |
        from lsst.analysis.tools.atools.diffMatched import (
          MatchedRefCoaddDiffMagTool,
          MatchedRefCoaddDiffPositionTool,
        )
