description: |
  Tier1 plots and metrics to assess repeatability of sources matched per tract
tasks:
  analyzeMatchedVisitCore:
    class: lsst.analysis.tools.tasks.AssociatedSourcesTractAnalysisTask
    config:
      connections.outputName: matchedVisitCore
      atools.PhotometricRepeatabilityMetric: PhotometricRepeatability
      atools.stellarPhotometricResiduals: StellarPhotometricResidualsFocalPlane
      atools.stellarAstrometricResidualsRA: StellarAstrometricResidualsRAFocalPlanePlot
      atools.stellarAstrometricResidualsDec: StellarAstrometricResidualsDecFocalPlanePlot
      atools.stellarAstrometricResidualStdDevRA: StellarAstrometricResidualStdDevRAFocalPlanePlot
      atools.stellarAstrometricResidualStdDevDec: StellarAstrometricResidualStdDevDecFocalPlanePlot
      atools.stellarAstrometricRepeatability1: AstrometricRelativeRepeatability
      atools.stellarAstrometricRepeatability1.xValue: 1
      atools.stellarAstrometricRepeatability1.process.calculateActions.rms.annulus: 5
      atools.stellarAstrometricRepeatability2: AstrometricRelativeRepeatability
      atools.stellarAstrometricRepeatability2.xValue: 2
      atools.stellarAstrometricRepeatability2.process.calculateActions.rms.annulus: 20
      atools.stellarAstrometricRepeatability3: AstrometricRelativeRepeatability
      atools.stellarAstrometricRepeatability3.xValue: 3
      atools.stellarAstrometricRepeatability3.process.calculateActions.rms.annulus: 200
      atools.stellarAstrometricRepeatability3.process.calculateActions.rms.threshAD: 30
      python: |
        from lsst.analysis.tools.atools import *
  analyzeMatchedVisitExtended:
    class: lsst.analysis.tools.tasks.AssociatedSourcesTractAnalysisTask
    config:
      bands: ['g', 'r', 'i', 'z', 'y']
      connections.outputName: matchedVisitExtended
      atools.modelPhotRepGalSn5to10: PhotometricRepeatability
      atools.modelPhotRepGalSn5to10.fluxType: cModelFlux
      atools.modelPhotRepGalSn5to10.process.filterActions.perGroupStdevFiltered.selectors.extendedness.op: gt
      atools.modelPhotRepGalSn5to10.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 5
      atools.modelPhotRepGalSn5to10.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 10
      atools.modelPhotRepGalSn5to10.produce.plot: NoPlot

      atools.modelPhotRepGalSn10to20: PhotometricRepeatability
      atools.modelPhotRepGalSn10to20.fluxType: cModelFlux
      atools.modelPhotRepGalSn10to20.process.filterActions.perGroupStdevFiltered.selectors.extendedness.op: gt
      atools.modelPhotRepGalSn10to20.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 10
      atools.modelPhotRepGalSn10to20.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 20
      atools.modelPhotRepGalSn10to20.produce.plot: NoPlot

      atools.modelPhotRepGalSn20to40: PhotometricRepeatability
      atools.modelPhotRepGalSn20to40.fluxType: cModelFlux
      atools.modelPhotRepGalSn20to40.process.filterActions.perGroupStdevFiltered.selectors.extendedness.op: gt
      atools.modelPhotRepGalSn20to40.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 20
      atools.modelPhotRepGalSn20to40.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 40
      atools.modelPhotRepGalSn20to40.produce.plot: NoPlot

      atools.modelPhotRepGalSn40to80: PhotometricRepeatability
      atools.modelPhotRepGalSn40to80.fluxType: cModelFlux
      atools.modelPhotRepGalSn40to80.process.filterActions.perGroupStdevFiltered.selectors.extendedness.op: gt
      atools.modelPhotRepGalSn40to80.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 40
      atools.modelPhotRepGalSn40to80.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 80
      atools.modelPhotRepGalSn40to80.produce.plot: NoPlot

      atools.modelPhotRepStarSn5to10: PhotometricRepeatability
      atools.modelPhotRepStarSn5to10.fluxType: cModelFlux
      atools.modelPhotRepStarSn5to10.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 5
      atools.modelPhotRepStarSn5to10.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 10
      atools.modelPhotRepStarSn5to10.produce.plot: NoPlot

      atools.modelPhotRepStarSn10to20: PhotometricRepeatability
      atools.modelPhotRepStarSn10to20.fluxType: cModelFlux
      atools.modelPhotRepStarSn10to20.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 10
      atools.modelPhotRepStarSn10to20.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 20
      atools.modelPhotRepStarSn10to20.produce.plot: NoPlot

      atools.modelPhotRepStarSn20to40: PhotometricRepeatability
      atools.modelPhotRepStarSn20to40.fluxType: cModelFlux
      atools.modelPhotRepStarSn20to40.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 20
      atools.modelPhotRepStarSn20to40.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 40
      atools.modelPhotRepStarSn20to40.produce.plot: NoPlot

      atools.modelPhotRepStarSn40to80: PhotometricRepeatability
      atools.modelPhotRepStarSn40to80.fluxType: cModelFlux
      atools.modelPhotRepStarSn40to80.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 40
      atools.modelPhotRepStarSn40to80.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 80
      atools.modelPhotRepStarSn40to80.produce.plot: NoPlot

      atools.psfPhotRepStarSn5to10: PhotometricRepeatability
      atools.psfPhotRepStarSn5to10.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 5
      atools.psfPhotRepStarSn5to10.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 10
      atools.psfPhotRepStarSn5to10.produce.plot: NoPlot

      atools.psfPhotRepStarSn10to20: PhotometricRepeatability
      atools.psfPhotRepStarSn10to20.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 10
      atools.psfPhotRepStarSn10to20.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 20
      atools.psfPhotRepStarSn10to20.produce.plot: NoPlot

      atools.psfPhotRepStarSn20to40: PhotometricRepeatability
      atools.psfPhotRepStarSn20to40.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 20
      atools.psfPhotRepStarSn20to40.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 40
      atools.psfPhotRepStarSn20to40.produce.plot: NoPlot

      atools.psfPhotRepStarSn40to80: PhotometricRepeatability
      atools.psfPhotRepStarSn40to80.process.filterActions.perGroupStdevFiltered.selectors.sn.minimum: 40
      atools.psfPhotRepStarSn40to80.process.filterActions.perGroupStdevFiltered.selectors.sn.maximum: 80
      atools.psfPhotRepStarSn40to80.produce.plot: NoPlot
      python: |
        from lsst.analysis.tools.atools import *
        from lsst.analysis.tools.interfaces import *
